<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com;">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
  <title>Suivi Table Ronde</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600;700&display=swap" rel="stylesheet">
  <style>

    :root {
      --primary-color: #6f4e37;
      --secondary-color: #8b5e3c;
      --accent-color: #d2a679;
      --highlight-color: #c87533;
      --background-color: #f7f3e8;
      --text-color: #4b382a;
      --card-bg: #ffffff;
      --border-color: rgba(125, 87, 63, 0.25);
      --transition-speed: 0.2s;
      --border-radius: 16px;
      --radius-lg: 20px;
      --radius-xl: 26px;
      --surface: rgba(255, 255, 255, 0.9);
      --surface-strong: rgba(255, 255, 255, 0.98);
      --glass-border: rgba(255, 255, 255, 0.6);
      --glass-blur: 14px;
      --shadow: 0 10px 24px rgba(75, 56, 42, 0.12);
      --shadow-strong: 0 20px 40px rgba(75, 56, 42, 0.2);
      --glow: 0 0 0 3px rgba(210, 166, 121, 0.35);
      --focus-ring: 0 0 0 3px rgba(200, 117, 51, 0.25);
      --gradient-main: radial-gradient(circle at top, #fdf6ec, #f4e2cb 45%, #e7cfb1 100%);
      --gradient-soft: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(247, 243, 232, 0.85));
      --gradient-accent: linear-gradient(120deg, #c87533, #d2a679, #f3d5aa);
      --gradient-hero: conic-gradient(from 210deg at 50% 50%, rgba(200, 117, 51, 0.18), rgba(210, 166, 121, 0.28), rgba(255, 255, 255, 0.8), rgba(200, 117, 51, 0.18));
      --space-xs: 6px;
      --space-sm: 12px;
      --space-md: 18px;
      --space-lg: 24px;
      --space-xl: 32px;
    }

    .valentine-theme {
      --primary-color: #d81b60;
      --secondary-color: #ad1457;
      --accent-color: #f48fb1;
      --highlight-color: #e91e63;
      --background-color: #fff0f5;
      --text-color: #880e4f;
      --border-color: #f48fb1;
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--gradient-main);
      color: var(--text-color);
      min-height: 100vh;
      line-height: 1.6;
      transition: background 0.3s ease, color 0.3s ease;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.45), transparent 50%),
        radial-gradient(circle at 80% 10%, rgba(210, 166, 121, 0.2), transparent 45%),
        radial-gradient(circle at 50% 90%, rgba(200, 117, 51, 0.2), transparent 55%);
      opacity: 0.7;
      pointer-events: none;
      z-index: -1;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    img {
      max-width: 100%;
    }

    .app-header {
      position: sticky;
      top: 0;
      z-index: 999;
      backdrop-filter: blur(18px);
      background: var(--glass-bg);
      border-bottom: 1px solid var(--glass-border);
      box-shadow: var(--shadow);
    }

    .nav-bar {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      gap: 16px;
      padding: 14px 24px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
      font-size: 1.1rem;
      color: var(--primary-color);
    }

    a:hover, a:focus {
      color: var(--highlight-color);
    }

    h1 {
      font-size: clamp(1.8rem, 3vw, 2.4rem);
      font-weight: 700;
    }

    h2 {
      font-size: 1.4rem;
      font-weight: 700;
    }

    h3 {
      font-size: 1.1rem;
      font-weight: 700;
    }

    p {
      font-size: 1rem;
      margin-bottom: 10px;
    }

    .helper-text {
      font-size: 0.85rem;
      color: var(--secondary-color);
    }

    ul {
      list-style: none;
      padding-left: 0;
    }

    .app-header {
      position: sticky;
      top: 0;
      z-index: 2000;
      background: rgba(255, 255, 255, 0.88);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.6);
      box-shadow: 0 8px 18px rgba(75, 56, 42, 0.08);
    }

    .navbar {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--space-md);
      padding: 16px 24px;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    .brand {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary-color);
    }

    .tagline {
      font-size: 0.85rem;
      color: var(--secondary-color);
      background: rgba(210, 166, 121, 0.2);
      padding: 4px 10px;
      border-radius: 999px;
    }

    .nav-center {
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }

    .nav-center a {
      font-weight: 600;
      font-size: 0.95rem;
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-toggle {
      display: none;
      border: 1px solid var(--glass-border);
      background: rgba(255, 255, 255, 0.7);
      border-radius: 10px;
      padding: 8px 12px;
      font-size: 1rem;
      cursor: pointer;
    }

    .app-main {
      max-width: 1200px;
      margin: 24px auto 60px;
      padding: 0 24px;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .card,
    .command-card,
    .score-card {
      background: var(--surface);
      border: 1px solid var(--glass-border);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: clamp(18px, 2.8vw, 28px);
      transition: transform var(--transition-speed), box-shadow var(--transition-speed);
      transform: translateY(var(--float-offset, 0px));
      backdrop-filter: blur(var(--glass-blur));
    }

    .card:hover,
    .command-card:hover,
    .score-card:hover {
      box-shadow: var(--shadow-strong);
    }

    .hero-card {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 24px;
      position: relative;
      overflow: hidden;
    }

    .hero-card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background: var(--gradient-hero);
      animation: slowSpin 18s linear infinite;
      opacity: 0.5;
      filter: blur(12px);
      pointer-events: none;
    }

    .hero-card > * {
      position: relative;
      z-index: 1;
    }

    .hero-content {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .eyebrow {
      text-transform: uppercase;
      font-size: 0.75rem;
      letter-spacing: 0.12em;
      color: var(--secondary-color);
    }

    .hero-subtitle {
      color: var(--secondary-color);
    }

    .hero-actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .status-grid {
      display: grid;
      gap: 12px;
    }

    .status-card {
      background: var(--surface-strong);
      border: 1px solid var(--glass-border);
      border-radius: var(--border-radius);
      padding: 14px;
      font-size: 0.95rem;
      box-shadow: var(--shadow);
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
    }

    .metric-card {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .score-display {
      font-size: 2rem;
      font-weight: 700;
      color: #fff;
    }

    .score-card {
      background: var(--gradient-accent);
      color: #fff;
    }

    .progress-container {
      width: 100%;
      background: rgba(210, 166, 121, 0.35);
      border-radius: 999px;
      overflow: hidden;
      padding: 4px;
    }

    .progress-bar {
      height: 16px;
      width: 0%;
      background: var(--gradient-accent);
      transition: width 0.5s ease, box-shadow 0.5s ease;
      border-radius: 999px;
      box-shadow: 0 8px 16px rgba(200, 117, 51, 0.35);
    }

    .content-grid {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1fr);
      gap: 24px;
    }

    .column {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 16px;
    }

    .section-header .helper-text {
      margin: 0;
    }

    .button-stack {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .file-btn,
    .btn,
    .modal-content button {
      min-height: 44px;
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-weight: 600;
      letter-spacing: 0.2px;
      background: var(--gradient-accent);
      color: #fff;
      transition: transform var(--transition-speed), box-shadow var(--transition-speed), background var(--transition-speed);
      box-shadow: 0 10px 18px rgba(200, 117, 51, 0.2);
    }

    .file-btn--ghost,
    .btn-ghost {
      min-height: 36px;
      background: rgba(210, 166, 121, 0.25);
      color: var(--primary-color);
      box-shadow: none;
    }

    .file-btn:hover,
    .btn:hover,
    .modal-content button:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 24px rgba(200, 117, 51, 0.28);
    }

    .file-btn--ghost:hover,
    .btn-ghost:hover {
      background: rgba(210, 166, 121, 0.4);
      transform: translateY(-1px);
    }

    .file-btn:focus-visible,
    .btn:focus-visible,
    .modal-content button:focus-visible {
      outline: none;
      box-shadow: var(--glow), var(--focus-ring);
    }

    input[type="number"],
    input[type="text"],
    textarea {
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 10px 12px;
      background: var(--surface-strong);
      font-size: 0.95rem;
    }

    input[type="number"]:focus,
    input[type="text"]:focus,
    textarea:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: var(--glow);
    }

    .task-item {
      padding: 14px 16px;
      border-radius: var(--border-radius);
      background: rgba(255, 255, 255, 0.72);
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow);
      margin-bottom: 14px;
    }

    .task-item:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-strong);
    }

    .subtask {
      margin-left: 18px;
      margin-top: 10px;
    }

    .subtask li {
      list-style-type: disc;
      margin-bottom: 10px;
    }

    input[type="checkbox"] {
      margin-right: 10px;
      transform: scale(1.1);
      vertical-align: middle;
      accent-color: var(--highlight-color);
    }

    .done {
      text-decoration: line-through;
      color: var(--secondary-color);
    }

    .command-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
      margin-top: 10px;
    }

    .command-card input,
    .command-card button,
    .command-card textarea {
      width: 100%;
    }

    .command-card .helper-text {
      font-size: 0.85rem;
      color: var(--secondary-color);
    }

    .command-card .command-hints {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }

    .command-card .command-chip {
      background: var(--background-color);
      border: 1px solid var(--border-color);
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 0.8rem;
    }

    .coin {
      display: inline-block;
      margin: 5px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--accent-color);
      color: var(--card-bg);
      text-align: center;
      line-height: 40px;
      font-weight: bold;
    }

    #desktop {
      position: relative;
      width: 100%;
      min-height: 280px;
      border: 2px dashed var(--glass-border);
      border-radius: var(--border-radius);
      background: rgba(255, 255, 255, 0.4);
      padding: 10px;
      overflow: hidden;
    }

    .window {
      position: absolute;
      width: min(320px, 100%);
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow);
    }

    .window-header {
      background: var(--gradient-accent);
      color: #fff;
      padding: 8px 10px;
      border-radius: var(--radius-md) var(--radius-md) 0 0;
      cursor: move;
      border-top-left-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
    }

    .window-content {
      padding: 10px;
    }

    .window-footer {
      text-align: right;
      padding: 6px 8px;
      font-size: 0.8rem;
      color: var(--secondary-color);
    }

    .modal.story-modal,
    .modal.master-modal,
    .modal.easter-modal {
      display: none;
      position: fixed;
      z-index: 1200;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.8);
    }

    .modal-content {
      background-color: var(--surface);
      margin: 10% auto;
      padding: 24px;
      border: 1px solid var(--glass-border);
      width: 90%;
      max-width: 540px;
      border-radius: var(--border-radius);
      text-align: center;
      box-shadow: var(--shadow-strong);
      backdrop-filter: blur(var(--glass-blur));
    }

    .modal-actions {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 16px 0;
    }

    .whiteout-overlay {
      position: fixed;
      inset: 0;
      background: #fff;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1400;
      color: #2b1c14;
      text-align: center;
      padding: 20px;
    }

    .whiteout-overlay.is-active {
      display: flex;
    }

    .whiteout-overlay .whiteout-content {
      max-width: 420px;
      background: #fff;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 20px;
      box-shadow: var(--shadow-strong);
    }

    .whiteout-overlay strong {
      display: block;
      font-size: 1.4rem;
      margin-bottom: 10px;
    }

    footer {
      max-width: 1200px;
      margin: 0 auto 30px;
      background: linear-gradient(135deg, var(--accent-color), var(--highlight-color));
      padding: 20px 10px;
      text-align: center;
      color: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
    }

    footer .social-links a {
      margin: 0 10px;
      color: var(--card-bg);
    }

    @keyframes slowSpin {
      to {
        transform: rotate(360deg);
      }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @keyframes swapClean {
      0% { background-color: transparent; }
      50% { background-color: var(--accent-color); }
      100% { background-color: transparent; }
    }

    @keyframes whiteoutPulse {
      0% { opacity: 0.98; }
      50% { opacity: 0.9; }
      100% { opacity: 0.98; }
    }

    .pulse {
      animation: pulse 0.5s ease;
    }

    .swap-clean {
      animation: swapClean 0.6s ease;
    }

    @media (max-width: 1024px) {
      .content-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 900px) {
      .navbar {
        flex-wrap: wrap;
      }

      .nav-toggle {
        display: inline-flex;
      }

      .nav-center {
        width: 100%;
        order: 3;
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
        padding: 12px 0 4px;
        display: none;
      }

      .nav-center.is-open {
        display: flex;
      }

      .nav-right {
        margin-left: auto;
      }

      .hero-actions {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
        padding: 12px 0;
      }
    }

    @media (max-width: 600px) {
      .app-main {
        padding: 0 16px;
      }

      .navbar {
        padding: 12px 16px;
      }

      .window {
        position: static;
        margin-bottom: var(--space-md);
      }

      #desktop {
        display: grid;
        gap: 16px;
      }

      .window {
        position: static;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation: none !important;
        transition-duration: 0.01ms !important;
      }

      .card,
      .command-card,
      .score-card {
        transform: none !important;
      }
    }

  </style>
</head>
<body>

  <!-- Master Control Modal -->
  <div id="masterModal" class="modal">
    <div class="modal-content">
      <h2>Le Panel</h2>
      <p>Bienvenue ! Choisissez ce qui vous inspire aujourd'hui :</p>
      <div class="modal-actions">
        <a href="saintvalentin.html" class="file-btn">üíñ Jeu de Saint-Valentin</a>
        <button class="file-btn" onclick="focusNotepad()">Ouvrir</button>
        <a href="bubbleRoom.html" class="file-btn">Suivant</a>
      </div>
      <button class="file-btn file-btn--ghost" onclick="closeMasterModal()">Fermer</button>
    </div>
  </div>

  <!-- Story Helper Modal -->
  <div id="storyModal" class="modal">
    <div class="modal-content">
      <h2>Bienvenue dans l'univers enchant√© de #suivi-table-ronde</h2>
      <p>
        Cet outil magique vous guide √† travers une aventure captivante :<br>
        <a
          href="https://www.github.com/kvnbbg/suivi-table-ronde/bubbleRoom.html"
          target="_blank"
          rel="noopener noreferrer"
          title="feedbacks"
          aria-label="feedbacks"
        >
          ‚Ä¢ V√©rifiez vos emails avec soin<br>
          ‚Ä¢ Confirmez vos contributions avec fiert√©<br>
          ‚Ä¢ Pr√©parez votre r√©union comme dans un conte de f√©es<br>
          ‚Ä¢ Planifiez le suivi post-√©v√©nement avec √©l√©gance<br>
        </a>
        <br>
        Chaque √©tape est un chapitre d'un merveilleux livre d'aventures interactives.
      </p>
      <button id="closeStory" class="file-btn">Fermer l'aide</button>
    </div>
  </div>

  <!-- Easter Egg Modal -->
  <div id="easterModal" class="modal">
    <div class="modal-content">
      <h2>Joyeuse Saint Valentin !</h2>
      <p>F√©licitations, vous avez d√©couvert ! Bonus : +50 points</p>
      <p>Voici le lien magique :</p>
      <a href="sainvalentin.html" class="file-btn file-btn--ghost">Acc√©der</a>
      <br>
      <button id="closeEaster" class="file-btn">Fermer</button>
    </div>
  </div>

  <div id="whiteoutOverlay" class="whiteout-overlay" aria-hidden="true">
    <div class="whiteout-content">
      <strong>Pause Whiteout en cours</strong>
      <p>Prenez un moment pour respirer et revenir avec √©nergie.</p>
      <p>Temps restant : <span id="whiteoutTimer">05:00</span></p>
      <button id="whiteoutStopOverlay" class="btn btn--primary">Revenir √† la session</button>
    </div>
  </div>

  <header class="app-header">
    <div class="navbar">
      <div class="nav-left">
        <a class="brand" href="index.html">Suivi Table Ronde</a>
        <span class="tagline">Dashboard</span>
      </div>
      <button class="nav-toggle" id="navToggle" aria-expanded="false" aria-controls="primaryNav">‚ò∞</button>
      <nav class="nav-center" id="primaryNav">
        <a href="#dashboard">Dashboard</a>
        <a href="#tasks">T√¢ches</a>
        <a href="#focus">Focus</a>
        <a href="#command-center">Commandes</a>
        <a href="#contact">Contact</a>
      </nav>
      <div class="nav-right">
        <button id="themeToggle" class="btn btn-ghost">Mode</button>
        <button class="btn btn-ghost" type="button">FR</button>
        <a href="community.html" class="btn btn-ghost">Profil</a>
        <button class="btn" onclick="openMasterModal()">Panel</button>
      </div>
    </div>
  </header>

  <main class="app-main" id="dashboard">
    <noscript>
      <div class="card">
        <strong>JavaScript est n√©cessaire.</strong>
        <p>Activez JavaScript pour profiter des animations et des fonctions interactives.</p>
      </div>
    </noscript>

    <section class="card hero-card" aria-labelledby="heroTitle">
      <div class="hero-content">
        <p class="eyebrow">Table ronde ‚Ä¢ Pilotage</p>
        <h1 id="heroTitle">Suivi Table Ronde</h1>
        <p class="hero-subtitle">
          Un poste de pilotage clair et actionnable pour pr√©parer, animer et suivre votre table ronde.
        </p>
        <div class="hero-actions">
          <button class="file-btn" onclick="openMasterModal()">Ouvrir le panel</button>
          <a class="file-btn file-btn--ghost" href="community.html">Journal communautaire</a>
          <a class="file-btn file-btn--ghost" href="bubbleRoom.html">Salle immersive</a>
        </div>
      </div>
      <div class="stats-grid">
        <div class="stat-card">
          <strong>Vue rapide</strong>
          <p>Progression, score, focus et t√¢ches critiques au m√™me endroit.</p>
        </div>
        <div class="stat-card">
          <strong>Mode focus</strong>
          <p>Whiteout + rappel intelligent pour reprendre la t√¢che prioritaire.</p>
        </div>
        <div class="stat-card">
          <strong>Suivi transparent</strong>
          <p>Historique communautaire, export et partage imm√©diat.</p>
        </div>
      </div>
    </section>

    <section class="metrics-grid" aria-label="Indicateurs cl√©s">
      <div class="card score-card metric-card">
        <h2>Score</h2>
        <div class="score-display"><span id="scoreDisplay">0</span> pts</div>
        <p class="helper-text">Suivez l'impact des actions valid√©es.</p>
      </div>
      <div class="card metric-card">
        <h2>Progression</h2>
        <div class="progress-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>
        <p class="helper-text">Chaque t√¢che valid√©e met √† jour cette barre.</p>
      </div>
      <div class="card metric-card">
        <h2>Acc√®s rapide</h2>
        <div class="button-stack">
          <a class="btn btn-ghost" href="#tasks">Voir les t√¢ches</a>
          <a class="btn btn-ghost" href="#focus">Mode focus</a>
          <a class="btn btn-ghost" href="#command-center">Commandes</a>
        </div>
      </div>
    </section>

    <div class="content-grid">
      <div class="column primary">
        <section class="card" id="tasks">
          <div class="section-header">
            <h2>T√¢ches √† accomplir</h2>
            <button id="resetBtn" class="file-btn file-btn--ghost">R√©initialiser</button>
          </div>
          <ul id="taskList">
            <li class="task-item">
              <label>
                <input type="checkbox" class="task-checkbox">
                <strong>V√©rification de l'Email</strong>
              </label>
              <ul class="subtask">
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    S‚Äôassurer que l‚Äôemail contenant vos questions et la liste des participants a bien √©t√© re√ßu.
                  </label>
                </li>
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    V√©rifier l'int√©grit√© et l‚Äôaccessibilit√© des pi√®ces jointes.
                  </label>
                </li>
              </ul>
            </li>
            <li class="task-item">
              <label>
                <input type="checkbox" class="task-checkbox">
                <strong>Confirmation de la Prise en Compte</strong>
              </label>
              <ul class="subtask">
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    Contacter l‚Äôorganisateur pour confirmer que vos contributions ont √©t√© enregistr√©es malgr√© le retard.
                  </label>
                </li>
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    Demander s‚Äôil y a des informations suppl√©mentaires ou des ajustements √† pr√©voir.
                  </label>
                </li>
              </ul>
            </li>
            <li class="task-item">
              <label>
                <input type="checkbox" class="task-checkbox">
                <strong>Pr√©paration pour la Table Ronde</strong>
              </label>
              <ul class="subtask">
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    Relire et finaliser vos questions pour l'intervenante.
                  </label>
                </li>
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    R√©viser la liste des participants et la mettre √† jour si n√©cessaire.
                  </label>
                </li>
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    Pr√©parer les points de discussion pour √™tre pr√™t lors de l‚Äô√©v√©nement.
                  </label>
                </li>
              </ul>
            </li>
            <li class="task-item">
              <label>
                <input type="checkbox" class="task-checkbox">
                <strong>Suivi Post-√âv√©nement</strong>
              </label>
              <ul class="subtask">
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    Planifier une r√©union ou un suivi apr√®s la table ronde pour discuter des retours et des prochaines √©tapes.
                  </label>
                </li>
                <li>
                  <label>
                    <input type="checkbox" class="task-checkbox">
                    Conserver une copie de tous les √©changes et documents pour r√©f√©rence future.
                  </label>
                </li>
              </ul>
            </li>
          </ul>
        </section>

        <section class="card" id="command-center">
          <div class="section-header">
            <h2>Centre de commande interactif</h2>
            <p class="helper-text">Tout ce qu‚Äôil faut pour piloter vos actions quotidiennes.</p>
          </div>
          <div class="command-grid">
            <div class="command-card">
              <h3>Commandes rapides</h3>
              <p class="helper-text">Tapez une commande et appuyez sur Entr√©e.</p>
              <input type="text" id="commandInput" placeholder="reset, next, toggle, aujourdh8onsa1m1">
              <div class="command-hints">
                <span class="command-chip">reset</span>
                <span class="command-chip">next</span>
                <span class="command-chip">toggle</span>
                <span class="command-chip">aujourdh8onsa1m1</span>
              </div>
            </div>
            <div class="command-card">
              <h3>Calcul express</h3>
              <p class="helper-text">Gagnez du temps avec un mini-calculateur int√©gr√©.</p>
              <input type="text" id="mathInput" placeholder="Ex: (12 + 6) * 2">
              <button id="calcBtn" class="file-btn">Calculer</button>
              <p id="mathResult" class="helper-text">R√©sultat : ‚Äî</p>
            </div>
            <div class="command-card">
              <h3>Jeu des pi√®ces</h3>
              <p class="helper-text">Testez la fusion optimale des pi√®ces.</p>
              <input type="text" id="coinsInput" placeholder="Ex: 1, 3, 7, 10">
              <input type="number" id="thresholdInput" min="1" value="15">
              <button id="startCoinGame" class="file-btn">Lancer</button>
              <div id="coinDisplay"></div>
              <div id="coinLog" class="helper-text"></div>
            </div>
          </div>
        </section>
      </div>

      <div class="column secondary">
        <section class="card" id="focus">
          <div class="section-header">
            <h2>Pause Whiteout &amp; Focus</h2>
            <p class="helper-text">Une pause visuelle pour revenir avec clart√©.</p>
          </div>
          <div class="command-grid">
            <div class="command-card">
              <label for="whiteoutMinutes"><strong>Dur√©e (minutes)</strong></label>
              <input id="whiteoutMinutes" type="number" min="1" max="30" value="5">
              <p class="helper-text">Recommand√© : 5 √† 10 minutes pour recharger l‚Äôattention.</p>
              <button id="whiteoutStart" class="file-btn">D√©marrer la pause</button>
              <button id="whiteoutStop" class="file-btn file-btn--ghost">Arr√™ter</button>
            </div>
            <div class="command-card">
              <h3>Focus rapide</h3>
              <p class="helper-text">Un rappel doux pour reprendre la prochaine t√¢che essentielle.</p>
              <button id="focusNextTask" class="file-btn">Valider la prochaine t√¢che</button>
              <button id="focusThemeToggle" class="file-btn file-btn--ghost">Basculer le th√®me</button>
            </div>
          </div>
        </section>

        <section class="card" id="solutions">
          <h2>Nouvelles solutions ‚ù§Ô∏è</h2>
          <p>Nous proposons des solutions logicielles innovantes, notamment des applications Format Famille.</p>
        </section>

        <section class="card" id="contact">
          <h2>Contact &amp; Collaboration</h2>
          <p>Pour toute collaboration ou signalement de bug, contactez-moi via les moyens ci-dessous.</p>
          <div style="text-align:center;">
            <button class="file-btn" onclick="toggleContactInfo()">Afficher les informations de contact</button>
          </div>
          <div id="contactInfo" style="display:none; text-align:center; margin-top:10px;">
            <p>
              <strong>Fran√ßais:</strong><br>
              Email : <a href="mailto:kevinmarville@gmail.com">kevinmarville@gmail.com</a><br>
              T√©l√©phone : +33 XXX XXX XXX
            </p>
            <p>
              <strong>English:</strong><br>
              Email: <a href="mailto:kevinmarville@gmail.com">kevinmarville@gmail.com</a><br>
              Phone: +1-XXX-XXX-XXX
            </p>
            <p>
              <strong>‰∏≠Êñá:</strong><br>
              ÈÇÆÁÆ±: <a href="mailto:kevinmarville@gmail.com">kevinmarville@gmail.com</a><br>
              ÁîµËØù: +86 XXX XXX XXX
            </p>
            <p>
              <a href="https://www.linkedin.com/in/marvillekevin" target="_blank" class="file-btn">LinkedIn</a>
              <a href="https://bsky.app/profile/techandstream.bsky.social" target="_blank" class="file-btn">Bluesky</a>
            </p>
          </div>
          <p style="margin-top:20px; font-size:0.9rem;">
            Security Note: This site uses measures to safeguard against malicious.
          </p>
        </section>
      </div>
    </div>

    <section class="card" id="memo">
      <h2>M√©mo</h2>
      <div id="desktop">
        <div class="window" id="notesWindow" style="top: 20px; left: 20px;">
          <div class="window-header">Notes</div>
          <div class="window-content">
            <textarea id="notesArea" style="width:100%; height:100px; border:1px solid var(--border-color); border-radius:var(--border-radius);"></textarea>
            <br>
            <button class="file-btn" onclick="saveNotes()">Sauvegarder</button>
          </div>
          <div class="window-footer">Attrape</div>
        </div>
        <div class="window" id="fileViewerWindow" style="top: 160px; left: 320px;">
          <div class="window-header">Zoom</div>
          <div class="window-content">
            <p>Ici, vous pouvez visualiser vos donn√©es virtuelles.</p>
            <button class="file-btn" onclick="openVirtualFile()">Ouvrir Fichier</button>
            <div id="virtualFileContent" style="margin-top:10px; font-size:0.9rem;"></div>
          </div>
          <div class="window-footer"><a href="https://ko-fi.com/kevinmarville">üí≥</a></div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="social-links">
      <a href="https://bsky.app/profile/techandstream.bsky.social" target="_blank">Bluesky</a>
      <a href="https://my.bio/kvnbbg" target="_blank">Threads</a>
    </div>
    <p>&copy; 2025 Kevin Marville. All rights reserved.</p>
  </footer>

  <script>
    const $ = (selector) => document.querySelector(selector);
    const $$ = (selector) => Array.from(document.querySelectorAll(selector));
    const addListener = (el, event, handler) => {
      if (el) el.addEventListener(event, handler);
    };
    const checkboxes = $$('.task-checkbox');
    const progressBar = $('#progressBar');
    const resetBtn = $('#resetBtn');
    const commandInput = $('#commandInput');
    const mathInput = $('#mathInput');
    const calcBtn = $('#calcBtn');
    const mathResult = $('#mathResult');
    const scoreDisplay = $('#scoreDisplay');
    const body = document.body;
    const easterModal = $('#easterModal');
    const closeEaster = $('#closeEaster');
    const storyModal = $('#storyModal');
    const closeStory = $('#closeStory');
    const masterModal = $('#masterModal');
    const whiteoutOverlay = $('#whiteoutOverlay');
    const whiteoutTimer = $('#whiteoutTimer');
    const whiteoutMinutes = $('#whiteoutMinutes');
    const whiteoutStart = $('#whiteoutStart');
    const whiteoutStop = $('#whiteoutStop');
    const whiteoutStopOverlay = $('#whiteoutStopOverlay');
    const focusNextTaskBtn = $('#focusNextTask');
    const focusThemeToggle = $('#focusThemeToggle');
    const themeToggle = $('#themeToggle');
    const navToggle = $('#navToggle');
    const primaryNav = $('#primaryNav');
    
    let score = 0;
    const totalTasks = checkboxes.length;

    function updateProgress() {
      const completed = $$('.task-checkbox:checked').length;
      const percent = (completed / totalTasks) * 100;
      if (progressBar) {
        progressBar.style.width = percent + '%';
      }
    }

    function updateScore(points) {
      score += points;
      if (score < 0) score = 0;
      if (scoreDisplay) scoreDisplay.textContent = score;
    }

    function handleCheckboxChange() {
      const label = this.parentElement;
      if (this.checked) {
        label.classList.add('done');
        updateScore(10);
      } else {
        label.classList.remove('done');
        updateScore(-10);
      }
      updateProgress();
    }

    function resetTasks() {
      checkboxes.forEach(cb => {
        if (cb.checked) {
          cb.checked = false;
          cb.parentElement.classList.remove('done');
        }
      });
      score = 0;
      if (scoreDisplay) scoreDisplay.textContent = score;
      updateProgress();
    }

    function validateNextTask() {
      for (let cb of checkboxes) {
        if (!cb.checked) {
          cb.checked = true;
          handleCheckboxChange.call(cb);
          break;
        }
      }
    }

    function calculateMath() {
      if (!mathInput || !mathResult) return;
      let expr = mathInput.value;
      try {
        let result = Function('"use strict"; return (' + expr + ')')();
        mathResult.textContent = 'R√©sultat : ' + result;
      } catch (error) {
        mathResult.textContent = 'Expression invalide.';
      }
    }

    function toggleValentineTheme() {
      body.classList.toggle('valentine-theme');
    }

    function triggerEasterEgg() {
      updateScore(50);
      if (easterModal) easterModal.style.display = 'block';
    }

    addListener(closeEaster, 'click', () => {
      if (easterModal) easterModal.style.display = 'none';
    });

    addListener(closeStory, 'click', () => {
      if (storyModal) storyModal.style.display = 'none';
    });

    function openMasterModal() {
      if (masterModal) masterModal.style.display = 'block';
    }

    function closeMasterModal() {
      if (masterModal) masterModal.style.display = 'none';
    }

    function focusNotepad() {
      const notesWindow = document.getElementById('notesWindow');
      if (notesWindow) {
        notesWindow.style.zIndex = 1300;
        notesWindow.style.border = '2px solid var(--highlight-color)';
      }
      closeMasterModal();
    }

    function toggleContactInfo() {
      const contactInfo = document.getElementById('contactInfo');
      if (!contactInfo) return;
      contactInfo.style.display = contactInfo.style.display === 'none' ? 'block' : 'none';
    }

    function makeDraggable(el) {
      let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
      const header = el.querySelector('.window-header');
      if (header) {
        header.onmousedown = dragMouseDown;
      } else {
        el.onmousedown = dragMouseDown;
      }
      function dragMouseDown(e) {
        e = e || window.event;
        e.preventDefault();
        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        document.onmousemove = elementDrag;
      }
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        el.style.top = (el.offsetTop - pos2) + 'px';
        el.style.left = (el.offsetLeft - pos1) + 'px';
      }
      function closeDragElement() {
        document.onmouseup = null;
        document.onmousemove = null;
      }
    }

    const windows = $$('.window');
    windows.forEach(win => makeDraggable(win));

    function saveNotes() {
      const notesArea = document.getElementById('notesArea');
      if (!notesArea) return;
      const notes = notesArea.value;
      localStorage.setItem('virtualNotes', notes);
      alert('Notes sauvegard√©es !');
    }

    window.addEventListener('load', () => {
      const savedNotes = localStorage.getItem('virtualNotes');
      const notesArea = document.getElementById('notesArea');
      if (savedNotes && notesArea) {
        notesArea.value = savedNotes;
      }
    });

    function openVirtualFile() {
      const fileContentDiv = document.getElementById('virtualFileContent');
      const equation = 'E = mc¬≤';
      fileContentDiv.innerHTML = `<p>Contenu du fichier virtuel :</p><p>Une √©quation c√©l√®bre : <strong>${equation}</strong></p>`;
    }

    const startCoinGameBtn = $('#startCoinGame');
    const coinsInput = $('#coinsInput');
    const thresholdInput = $('#thresholdInput');
    const coinDisplay = $('#coinDisplay');
    const coinLog = $('#coinLog');

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    function renderCoins(coins) {
      if (!coinDisplay) return;
      coinDisplay.innerHTML = '';
      coins.forEach(val => {
        const coinEl = document.createElement('div');
        coinEl.className = 'coin';
        coinEl.textContent = val;
        coinDisplay.appendChild(coinEl);
      });
    }

    async function playCoinGame(coins, threshold) {
      let operations = 0;
      renderCoins(coins);
      if (coinLog) coinLog.innerHTML = '';
      while (coins.length > 1 && coins.some(val => val < threshold)) {
        coins.sort((a, b) => a - b);
        const x = coins.shift();
        const y = coins.shift();
        const newCoin = Math.min(x, y) * 2 + Math.max(x, y);
        operations++;
        if (coinLog) {
          coinLog.innerHTML += `<p>Op√©ration ${operations} : Fusion de ${x} et ${y} pour cr√©er ${newCoin}</p>`;
        }
        await sleep(1000);
        coins.push(newCoin);
        renderCoins(coins);
        await sleep(500);
      }
      if (coinLog) {
        coinLog.innerHTML += `<p><strong>Nombre minimum d'op√©rations n√©cessaires : ${operations}</strong></p>`;
      }
    }

    if (startCoinGameBtn) {
      startCoinGameBtn.addEventListener('click', () => {
        if (!coinsInput || !thresholdInput) return;
        const coinsStr = coinsInput.value;
        const threshold = parseInt(thresholdInput.value, 10);
        if (!coinsStr || isNaN(threshold)) {
          alert('Veuillez entrer des pi√®ces valides et un seuil.');
          return;
        }
        const coins = coinsStr.split(',').map(s => parseInt(s.trim())).filter(n => !isNaN(n));
        playCoinGame(coins, threshold);
      });
    }

    let whiteoutInterval = null;
    let remainingSeconds = 0;

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
      const secs = Math.floor(seconds % 60).toString().padStart(2, '0');
      return `${mins}:${secs}`;
    }

    function setWhiteoutActive(active) {
      if (!whiteoutOverlay) return;
      whiteoutOverlay.classList.toggle('is-active', active);
      whiteoutOverlay.setAttribute('aria-hidden', String(!active));
    }

    function updateWhiteoutDisplay() {
      if (whiteoutTimer) {
        whiteoutTimer.textContent = formatTime(remainingSeconds);
      }
    }

    function stopWhiteout() {
      if (whiteoutInterval) {
        clearInterval(whiteoutInterval);
        whiteoutInterval = null;
      }
      setWhiteoutActive(false);
    }

    function startWhiteout() {
      if (!whiteoutMinutes) return;
      const minutes = parseInt(whiteoutMinutes.value, 10);
      if (isNaN(minutes) || minutes <= 0) {
        alert('Veuillez choisir une dur√©e valide.');
        return;
      }
      remainingSeconds = Math.min(minutes, 30) * 60;
      updateWhiteoutDisplay();
      setWhiteoutActive(true);
      if (whiteoutInterval) clearInterval(whiteoutInterval);
      whiteoutInterval = setInterval(() => {
        remainingSeconds -= 1;
        updateWhiteoutDisplay();
        if (remainingSeconds <= 0) {
          stopWhiteout();
        }
      }, 1000);
    }

    checkboxes.forEach(cb => {
      cb.addEventListener('change', handleCheckboxChange);
    });
    addListener(resetBtn, 'click', resetTasks);
    addListener(calcBtn, 'click', calculateMath);

    document.addEventListener('keydown', function (e) {
      if (e.altKey && e.key.toLowerCase() === 'r') {
        e.preventDefault();
        resetTasks();
      }
      if (e.altKey && e.key.toLowerCase() === 'n') {
        e.preventDefault();
        validateNextTask();
      }
      if (e.altKey && e.key.toLowerCase() === 't') {
        e.preventDefault();
        toggleValentineTheme();
      }
    });

    addListener(commandInput, 'keydown', function (e) {
      if (e.key === 'Enter') {
        const command = commandInput.value.trim().toLowerCase();
        if (command === 'reset') {
          resetTasks();
        } else if (command === 'next') {
          validateNextTask();
        } else if (command === 'toggle') {
          toggleValentineTheme();
        } else if (command === 'aujourdh8onsa1m1') {
          triggerEasterEgg();
        }
        commandInput.value = '';
      }
    });

    addListener(whiteoutStart, 'click', startWhiteout);
    addListener(whiteoutStop, 'click', stopWhiteout);
    addListener(whiteoutStopOverlay, 'click', stopWhiteout);
    addListener(focusNextTaskBtn, 'click', validateNextTask);
    addListener(focusThemeToggle, 'click', toggleValentineTheme);
    addListener(themeToggle, 'click', toggleValentineTheme);
    addListener(navToggle, 'click', () => {
      if (!primaryNav) return;
      const isOpen = primaryNav.classList.toggle('is-open');
      navToggle.setAttribute('aria-expanded', String(isOpen));
    });
  </script>
</body>
</html>
