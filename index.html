<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com;">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
  <title>Suivi Table Ronde</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* ================================
       Global Variables ‚Äì Warm Coffee Palette
       ================================ */
    :root {
      --primary-color: #6f4e37; /* Dark coffee */
      --secondary-color: #8b5e3c; /* Medium coffee */
      --accent-color: #d2a679;    /* Latte */
      --highlight-color: #c87533; /* Copper coffee */
      --background-color: #f7f3e8;  /* Light cream */
      --text-color: #4b382a;       /* Dark brown text */
      --card-bg: #ffffff;
      --border-color: #d2a679;
      --transition-speed: 0.2s;
      --border-radius: 3px;
      --shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      --shadow-strong: 0 8px 20px rgba(75, 56, 42, 0.15);
      --glow: 0 0 0 3px rgba(210, 166, 121, 0.35);
    }
    /* Valentine Theme Overrides */
    .valentine-theme {
      --primary-color: #d81b60;
      --secondary-color: #ad1457;
      --accent-color: #f48fb1;
      --highlight-color: #e91e63;
      --background-color: #fff0f5;
      --text-color: #880e4f;
      --border-color: #f48fb1;
    }
    
    /* ================================
       Reset & Base Styles
       ================================ */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #f7e8d0, #e8d2b8);
      color: var(--text-color);
      padding: 20px;
      min-height: 100vh;
      line-height: 1.6;
      transition: background 0.3s ease, color 0.3s ease;
    }
    a {
      text-decoration: none;
      color: var(--primary-color);
      transition: color var(--transition-speed) ease;
    }
    a:hover, a:focus {
      color: var(--accent-color);
    }
    
    /* ================================
       Container & Card Styles
       ================================ */
    .container {
      max-width: 900px;
      margin: 20px auto;
      padding: 0 15px;
    }
    .hero {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(247, 243, 232, 0.95));
      border: 1px solid var(--border-color);
      border-radius: calc(var(--border-radius) * 2);
      padding: 24px;
      box-shadow: var(--shadow-strong);
      margin-bottom: 20px;
    }
    .hero-title {
      font-size: clamp(1.8rem, 4vw, 2.6rem);
      margin-bottom: 8px;
    }
    .hero-subtitle {
      font-size: 1rem;
      color: var(--secondary-color);
      margin-bottom: 16px;
    }
    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    .hero-actions .file-btn {
      min-width: 160px;
    }
    .status-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }
    .status-card {
      background: var(--background-color);
      border: 1px dashed var(--border-color);
      border-radius: var(--border-radius);
      padding: 12px;
      text-align: left;
      font-size: 0.95rem;
    }
    .card, .command-card, .score-card {
      background-color: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 20px;
      margin-bottom: 20px;
      transition: background-color var(--transition-speed), box-shadow var(--transition-speed), transform 0.2s ease;
      transform: translateY(var(--float-offset, 0px));
    }
    .card:hover, .command-card:hover, .score-card:hover {
      box-shadow: var(--shadow-strong);
    }
    h1, h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    p {
      margin-bottom: 10px;
    }
    ul {
      list-style: none;
      padding-left: 0;
    }
    li {
      margin-bottom: 15px;
      position: relative;
      overflow: hidden;
    }
    li label {
      cursor: pointer;
      display: inline-block;
    }
    .subtask {
      margin-left: 20px;
      margin-top: 10px;
    }
    .subtask li {
      margin-bottom: 10px;
      list-style-type: disc;
    }
    input[type="checkbox"] {
      margin-right: 10px;
      transform: scale(1.2);
      vertical-align: middle;
    }
    .done {
      text-decoration: line-through;
      color: var(--secondary-color);
    }
    
    /* ================================
       Progress Bar
       ================================ */
    .progress-container {
      width: 100%;
      background: var(--accent-color);
      border-radius: var(--border-radius);
      overflow: hidden;
      margin-bottom: 20px;
    }
    .progress-bar {
      height: 20px;
      width: 0%;
      background: var(--highlight-color);
      transition: width 0.5s ease;
      position: relative;
      overflow: hidden;
    }
    .progress-bar::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, transparent, rgba(255, 255, 255, 0.5), transparent);
      transform: translateX(-100%);
      animation: shimmer 3s infinite;
    }
    
    /* ================================
       Animations
       ================================ */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    .pulse {
      animation: pulse 0.5s ease;
    }
    @keyframes swapClean {
      0% { background-color: transparent; }
      50% { background-color: var(--accent-color); }
      100% { background-color: transparent; }
    }
    .swap-clean {
      animation: swapClean 0.6s ease;
    }
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      50% { transform: translateX(100%); }
      100% { transform: translateX(100%); }
    }
    @keyframes floatIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes whiteoutPulse {
      0% { opacity: 0.98; }
      50% { opacity: 0.9; }
      100% { opacity: 0.98; }
    }
    
    /* ================================
       Social Preview SVG Styles
       ================================ */
    .social-preview {
      display: block;
      width: 100%;
      height: auto;
      max-width: 1280px;
      margin: 0 auto 20px;
    }
    
    /* ================================
       Command Card Styles
       ================================ */
    .command-card input[type="text"] {
      width: 80%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      margin-top: 10px;
    }
    .command-card p {
      margin-bottom: 10px;
      font-style: italic;
    }
    
    /* ================================
       Score Card
       ================================ */
    .score-card {
      text-align: center;
      font-size: 1.2rem;
      font-weight: bold;
    }
    
    /* ================================
       File Management Buttons
       ================================ */
    .file-btn {
      padding: 8px 16px;
      margin: 5px;
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      display: inline-block;
      text-align: center;
      transition: background var(--transition-speed);
    }
    .file-btn:hover {
      background: var(--accent-color);
    }
    #fileLog {
      margin-top: 10px;
      padding: 10px;
      background: var(--background-color);
      border-radius: var(--border-radius);
      max-height: 150px;
      overflow-y: auto;
      font-size: 0.9rem;
    }
    
    /* ================================
       Collapsible Folders for Various Data
       ================================ */
    .folder {
      background: var(--accent-color);
      color: var(--card-bg);
      padding: 10px;
      border-radius: var(--border-radius);
      margin-bottom: 10px;
      cursor: pointer;
      user-select: none;
    }
    .folder-content {
      display: none;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      background: var(--background-color);
    }
    
    /* ================================
       Virtual Desktop ‚Äì Draggable Windows
       ================================ */
    #desktop {
      position: relative;
      width: 100%;
      min-height: 300px;
      border: 2px dashed var(--border-color);
      border-radius: var(--border-radius);
      margin: 20px 0;
      overflow: hidden;
      padding: 10px;
      background: var(--background-color);
    }
    .window {
      position: absolute;
      width: 280px;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      transition: transform var(--transition-speed);
    }
    .window-header {
      background: var(--primary-color);
      color: #fff;
      padding: 8px;
      cursor: move;
      border-top-left-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
      user-select: none;
    }
    .window-content {
      padding: 10px;
      font-size: 0.95rem;
    }
    .window-footer {
      text-align: right;
      padding: 5px;
      font-size: 0.8rem;
      color: var(--secondary-color);
    }
    
    /* ================================
       Story Helper Modal (Pop-up Story)
       ================================ */
    .modal.story-modal {
      display: none;
      position: fixed;
      z-index: 1100;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.8);
    }
    .modal-content.story-content {
      background-color: var(--card-bg);
      margin: 10% auto;
      padding: 20px;
      border: 1px solid var(--border-color);
      width: 90%;
      max-width: 500px;
      border-radius: var(--border-radius);
      text-align: center;
    }
    .modal-content.story-content button {
      margin-top: 15px;
      padding: 10px 20px;
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: background var(--transition-speed);
    }
    .modal-content.story-content button:hover {
      background: var(--accent-color);
    }
    
    /* ================================
       Master Control Modal
       ================================ */
    .modal.master-modal {
      display: none;
      position: fixed;
      z-index: 1200;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.85);
    }
    .modal-content.master-content {
      background-color: var(--card-bg);
      margin: 10% auto;
      padding: 20px;
      border: 1px solid var(--border-color);
      width: 90%;
      max-width: 600px;
      border-radius: var(--border-radius);
      text-align: center;
    }
    .modal-content.master-content h2 {
      margin-bottom: 15px;
    }
    .modal-content.master-content .option-btn {
      margin: 10px;
      padding: 10px 20px;
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: background var(--transition-speed);
    }
    .modal-content.master-content .option-btn:hover {
      background: var(--accent-color);
    }
    
    /* ================================
       Easter Egg Modal
       ================================ */
    .modal.easter-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.8);
    }
    .modal-content.easter-content {
      background-color: var(--card-bg);
      margin: 15% auto;
      padding: 20px;
      border: 1px solid var(--border-color);
      width: 80%;
      max-width: 400px;
      border-radius: var(--border-radius);
      text-align: center;
    }
    .modal-content.easter-content button {
      margin-top: 15px;
      padding: 10px 20px;
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: background var(--transition-speed);
    }
    .modal-content.easter-content button:hover {
      background: var(--accent-color);
    }
    
    /* ================================
       Coins Game Card Styles
       ================================ */
    .coin {
      display: inline-block;
      margin: 5px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--accent-color);
      color: var(--card-bg);
      text-align: center;
      line-height: 40px;
      font-weight: bold;
      transition: transform 0.5s ease;
    }

    .command-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
      margin-top: 10px;
    }
    .command-card {
      animation: floatIn 0.4s ease;
    }
    .command-card input,
    .command-card button,
    .command-card textarea {
      width: 100%;
    }
    .command-card .helper-text {
      font-size: 0.85rem;
      color: var(--secondary-color);
    }
    .command-card .command-hints {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    .command-card .command-chip {
      background: var(--background-color);
      border: 1px solid var(--border-color);
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 0.8rem;
    }

    .whiteout-overlay {
      position: fixed;
      inset: 0;
      background: #fff;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1400;
      color: #2b1c14;
      text-align: center;
      padding: 20px;
    }
    .whiteout-overlay.is-active {
      display: flex;
      animation: whiteoutPulse 3s ease-in-out infinite;
    }
    .whiteout-overlay .whiteout-content {
      max-width: 420px;
      background: rgba(255, 255, 255, 0.85);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-strong);
      padding: 20px;
    }
    .whiteout-overlay strong {
      display: block;
      font-size: 1.4rem;
      margin-bottom: 10px;
    }
    
    /* ================================
       Contact & Collaboration Card (Modified Meta Section)
       ================================ */
    /* Contact & Collaboration Card */
    #contactCard {
      margin-top: 20px;
    }
    
    /* ================================
       Footer
       ================================ */
    footer {
      background: linear-gradient(135deg, var(--accent-color), var(--highlight-color));
      padding: 20px 10px;
      text-align: center;
      color: var(--card-bg);
      border-radius: var(--border-radius);
      margin-top: 20px;
    }
    footer .social-links a {
      margin: 0 10px;
      color: var(--card-bg);
      transition: transform var(--transition-speed);
    }
    footer .social-links a:hover {
      transform: scale(1.1);
    }
    
    /* ================================
       Responsive Styles
       ================================ */
    @media (max-width: 600px) {
      h1 { font-size: 1.8rem; }
      h2 { font-size: 1.5rem; }
      .card, .command-card, .score-card { padding: 15px; }
      input[type="checkbox"] { transform: scale(1); }
      .command-card input[type="text"] { width: 100%; }
      .window { width: 90%; }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation: none !important;
        transition-duration: 0.01ms !important;
      }
      .card, .command-card, .score-card {
        transform: none !important;
      }
    }
  </style>
</head>
<body>
  <!-- Master Control Modal -->
  <div id="masterModal" class="modal master-modal">
    <div class="modal-content master-content">
      <h2>Le Panel</h2>
      <p>
        Bienvenue ! Choisissez ce qui vous inspire aujourd'hui :
      </p><a href="saintvalentin.html">
      <button class="option-btn">
        üíñ Jeu de Saint-Valentin
      </button></a>
      <button class="option-btn" onclick="focusNotepad()">
        Ouvrir
      </button>
<a href="bubbleRoom.html">
  <button class="option-btn">Suivant</button>
</a>
       <!-- <button class="option-btn" onclick="window.open('https://ko-fi.com/kevinmarville', '_blank')">
        Soutenez-nous sur Ko‚Äëfi
      </button> -->
      <br><br>
      <button class="option-btn" onclick="closeMasterModal()">Fermer</button>
    </div>
  </div>

  <!-- Story Helper Modal -->
  <div id="storyModal" class="modal story-modal">
    <div class="modal-content story-content">
      <h2>Bienvenue dans l'univers enchant√© de #suivi-table-ronde</h2>
      <p>
        Cet outil magique vous guide √† travers une aventure captivante :<br>
          <a href="https://www.github.com/kvnbbg/suivi-table-ronde/bubbleRoom.html" 
   target="_blank" 
   rel="noopener noreferrer" 
   title="feedbacks" 
   aria-label="feedbacks">
    

        ‚Ä¢ V√©rifiez vos emails avec soin<br>
        ‚Ä¢ Confirmez vos contributions avec fiert√©<br>
        ‚Ä¢ Pr√©parez votre r√©union comme dans un conte de f√©es<br>
        ‚Ä¢ Planifiez le suivi post-√©v√©nement avec √©l√©gance<br>
        </a>
        <br>
        Chaque √©tape est un chapitre d'un merveilleux livre d'aventures interactives.
      </p>
      <button id="closeStory">Fermer l'aide</button>
    </div>
  </div>

  <!-- Easter Egg Modal -->
  <div id="easterModal" class="modal easter-modal">
    <div class="modal-content easter-content">
      <h2>Joyeuse Saint Valentin !</h2>
      <p>F√©licitations, vous avez d√©couvert ! Bonus : +50 points</p>
      <p>Voici le lien magique :</p>
      <a href="sainvalentin.html">Acc√©der</a>
      <br>
      <button id="closeEaster">Fermer</button>
    </div>
  </div>

  <div id="whiteoutOverlay" class="whiteout-overlay" aria-hidden="true">
    <div class="whiteout-content">
      <strong>Pause Whiteout en cours</strong>
      <p>Prenez un moment pour respirer et revenir avec √©nergie.</p>
      <p>Temps restant : <span id="whiteoutTimer">05:00</span></p>
      <button id="whiteoutStopOverlay" class="file-btn">Revenir √† la session</button>
    </div>
  </div>

  <div class="container">
    <noscript>
      <div class="card">
        <strong>JavaScript est n√©cessaire.</strong>
        <p>Activez JavaScript pour profiter des animations et des fonctions interactives.</p>
      </div>
    </noscript>

    <section class="hero" aria-labelledby="heroTitle">
      <h1 id="heroTitle" class="hero-title">Suivi Table Ronde</h1>
      <p class="hero-subtitle">
        Un poste de pilotage clair et actionnable pour pr√©parer, animer et suivre votre table ronde.
      </p>
      <div class="hero-actions">
        <button class="file-btn" onclick="openMasterModal()">Ouvrir le panel</button>
        <a class="file-btn" href="community.html">Journal communautaire</a>
        <a class="file-btn" href="bubbleRoom.html">Salle immersive</a>
      </div>
      <div class="status-grid">
        <div class="status-card">
          <strong>Vue rapide</strong>
          <p>Progression, score, focus et t√¢ches critiques au m√™me endroit.</p>
        </div>
        <div class="status-card">
          <strong>Mode focus</strong>
          <p>Whiteout + rappel intelligent pour reprendre la t√¢che prioritaire.</p>
        </div>
        <div class="status-card">
          <strong>Suivi transparent</strong>
          <p>Historique communautaire, export et partage imm√©diat.</p>
        </div>
      </div>
    </section>

    <!-- Score Card -->
    <div class="score-card">
      Score : <span id="scoreDisplay">0</span>
    </div>

    <!-- Master Button (always visible) -->
    <div style="text-align:center; margin-bottom:20px;">
      <button class="file-btn" onclick="openMasterModal()">Panel</button>
    </div>



    <!-- Progress Bar -->
    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="card">
      <h2>Pause Whiteout &amp; Focus</h2>
      <p>Activez un √©cran blanc pour une vraie pause visuelle et un retour clair.</p>
      <div class="command-grid">
        <div class="command-card">
          <label for="whiteoutMinutes"><strong>Dur√©e (minutes)</strong></label>
          <input id="whiteoutMinutes" type="number" min="1" max="30" value="5">
          <p class="helper-text">Recommand√© : 5 √† 10 minutes pour recharger l‚Äôattention.</p>
          <button id="whiteoutStart" class="file-btn">D√©marrer la pause</button>
          <button id="whiteoutStop" class="file-btn" style="background: var(--accent-color);">Arr√™ter</button>
        </div>
        <div class="command-card">
          <h3>Focus rapide</h3>
          <p class="helper-text">Un rappel doux pour reprendre la prochaine t√¢che essentielle.</p>
          <button id="focusNextTask" class="file-btn">Valider la prochaine t√¢che</button>
          <button id="focusThemeToggle" class="file-btn">Basculer le th√®me</button>
        </div>
      </div>
    </div>

    <!-- Tasks Card -->
    <div class="card">
      <h1>T√¢ches √† Accomplir</h1>
      <ul id="taskList">
        <li>
          <label>
            <input type="checkbox" class="task-checkbox">
            <strong>V√©rification de l'Email</strong>
          </label>
          <ul class="subtask">
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                S‚Äôassurer que l‚Äôemail contenant vos questions et la liste des participants a bien √©t√© re√ßu.
              </label>
            </li>
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                V√©rifier l'int√©grit√© et l‚Äôaccessibilit√© des pi√®ces jointes.
              </label>
            </li>
          </ul>
        </li>
        <li>
          <label>
            <input type="checkbox" class="task-checkbox">
            <strong>Confirmation de la Prise en Compte</strong>
          </label>
          <ul class="subtask">
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                Contacter l‚Äôorganisateur pour confirmer que vos contributions ont √©t√© enregistr√©es malgr√© le retard.
              </label>
            </li>
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                Demander s‚Äôil y a des informations suppl√©mentaires ou des ajustements √† pr√©voir.
              </label>
            </li>
          </ul>
        </li>
        <li>
          <label>
            <input type="checkbox" class="task-checkbox">
            <strong>Pr√©paration pour la Table Ronde</strong>
          </label>
          <ul class="subtask">
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                Relire et finaliser vos questions pour l'intervenante.
              </label>
            </li>
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                R√©viser la liste des participants et la mettre √† jour si n√©cessaire.
              </label>
            </li>
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                Pr√©parer les points de discussion pour √™tre pr√™t lors de l‚Äô√©v√©nement.
              </label>
            </li>
          </ul>
        </li>
        <li>
          <label>
            <input type="checkbox" class="task-checkbox">
            <strong>Suivi Post-√âv√©nement</strong>
          </label>
          <ul class="subtask">
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                Planifier une r√©union ou un suivi apr√®s la table ronde pour discuter des retours et des prochaines √©tapes.
              </label>
            </li>
            <li>
              <label>
                <input type="checkbox" class="task-checkbox">
                Conserver une copie de tous les √©changes et documents pour r√©f√©rence future.
              </label>
            </li>
          </ul>
        </li>
      </ul>
      <button id="resetBtn" class="file-btn" style="margin:20px auto; display:block;">R√©initialiser</button>
    </div>

    <!-- New Features Card -->
    <div class="card">
      <h2>Nouvelles Solutions ‚ù§Ô∏è</h2>
      <p>
        Nous proposons des solutions logicielles innovantes, notamment des applications Format Famille. .
      </p>
    </div>

    <div class="card">
      <h2>Centre de Commande Interactif</h2>
      <p>Tout ce qu‚Äôil faut pour piloter vos actions quotidiennes, en mode fluide et gamifi√©.</p>
      <div class="command-grid">
        <div class="command-card">
          <h3>Commandes rapides</h3>
          <p class="helper-text">Tapez une commande et appuyez sur Entr√©e.</p>
          <input type="text" id="commandInput" placeholder="reset, next, toggle, aujourdh8onsa1m1">
          <div class="command-hints">
            <span class="command-chip">reset</span>
            <span class="command-chip">next</span>
            <span class="command-chip">toggle</span>
            <span class="command-chip">aujourdh8onsa1m1</span>
          </div>
        </div>
        <div class="command-card">
          <h3>Calcul express</h3>
          <p class="helper-text">Gagnez du temps avec un mini-calculateur int√©gr√©.</p>
          <input type="text" id="mathInput" placeholder="Ex: (12 + 6) * 2">
          <button id="calcBtn" class="file-btn">Calculer</button>
          <p id="mathResult" class="helper-text">R√©sultat : ‚Äî</p>
        </div>
        <div class="command-card">
          <h3>Jeu des pi√®ces</h3>
          <p class="helper-text">Testez la fusion optimale des pi√®ces.</p>
          <input type="text" id="coinsInput" placeholder="Ex: 1, 3, 7, 10">
          <input type="number" id="thresholdInput" min="1" value="15">
          <button id="startCoinGame" class="file-btn">Lancer</button>
          <div id="coinDisplay"></div>
          <div id="coinLog" class="helper-text"></div>
        </div>
      </div>
    </div>

    

    <!-- Contact & Collaboration Card -->
    <div class="card" id="contactCard">
      <h2>Contact &amp; Collaboration</h2>
      <p>Pour toute collaboration ou signalement de bug, contactez-moi via les moyens ci-dessous.</p>
      <div style="text-align:center;">
        <button class="file-btn" onclick="toggleContactInfo()">Afficher les informations de contact</button>
      </div>
      <div id="contactInfo" style="display:none; text-align:center; margin-top:10px;">
        <p>
          <strong>Fran√ßais:</strong><br>
          Email : <a href="mailto:kevinmarville@gmail.com">kevinmarville@gmail.com</a><br>
          T√©l√©phone : +33 XXX XXX XXX
        </p>
        <p>
          <strong>English:</strong><br>
          Email: <a href="mailto:kevinmarville@gmail.com">kevinmarville@gmail.com</a><br>
          Phone: +1-XXX-XXX-XXX
        </p>
        <p>
          <strong>‰∏≠Êñá:</strong><br>
          ÈÇÆÁÆ±: <a href="mailto:kevinmarville@gmail.com">kevinmarville@gmail.com</a><br>
          ÁîµËØù: +86 XXX XXX XXX
        </p>
        <p>
          <a href="https://www.linkedin.com/in/marvillekevin" target="_blank" class="file-btn" style="margin:5px;">LinkedIn</a>
          <a href="https://bsky.app/profile/techandstream.bsky.social" target="_blank" class="file-btn" style="margin:5px;">Bluesky</a>
        </p>
      </div>
      <p style="margin-top:20px; font-size:0.9rem;">
        Security Note: This site uses measures to safeguard against malicious.
      </p>
    </div>

    <!-- Suivez-moi sur Meta (Optional Additional Links) 
    <div class="card">
      <h2>Restez Connect√©</h2>
      <p>D√©couvrez nos plugins VR/AR et suivez mes actualit√©s :</p>
      <div style="text-align:center;">
         target="_blank" class="file-btn" style="margin:5px;">CREATIONS</a>
        <a href="https://kvnbbg.fr" target="_blank" class="file-btn" style="margin:5px;">KVNBBG.FR</a>
      </div>
    </div>-->

    <!-- Virtual Desktop -->
    <div class="card">
      <h2>M√©mo</h2>
      <div id="desktop">
        <!-- Notes Window -->
        <div class="window" id="notesWindow" style="top: 20px; left: 20px;">
          <div class="window-header">Notes</div>
          <div class="window-content">
            <textarea id="notesArea" style="width:100%; height:100px; border:1px solid var(--border-color); border-radius:var(--border-radius);"></textarea>
            <br>
            <button class="file-btn" onclick="saveNotes()">Sauvegarder</button>
          </div>
          <div class="window-footer">Attrape</div>
        </div>
        <!-- Virtual File Viewer Window -->
        <div class="window" id="fileViewerWindow" style="top: 160px; left: 320px;">
          <div class="window-header">Zoom</div>
          <div class="window-content">
            <p>Ici, vous pouvez visualiser vos donn√©es virtuelles.</p>
            <button class="file-btn" onclick="openVirtualFile()">Ouvrir Fichier</button>
            <div id="virtualFileContent" style="margin-top:10px; font-size:0.9rem;"></div>
          </div>
          <div class="window-footer"><a href="https://ko-fi.com/kevinmarville">üí≥</a></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="social-links">
      <a href="https://bsky.app/profile/techandstream.bsky.social" target="_blank">Bluesky</a>
      <a href="https://my.bio/kvnbbg" target="_blank">Threads</a>
    </div>
    <p>&copy; 2025 Kevin Marville. All rights reserved.</p>
  </footer>

  <script>
    /* ======================================
       GLOBAL VARIABLES & SCORE
       ====================================== */
    const $ = (selector) => document.querySelector(selector);
    const $$ = (selector) => Array.from(document.querySelectorAll(selector));
    const addListener = (el, event, handler) => {
      if (el) el.addEventListener(event, handler);
    };
    const checkboxes = $$('.task-checkbox');
    const progressBar = $('#progressBar');
    const resetBtn = $('#resetBtn');
    const commandInput = $('#commandInput');
    const mathInput = $('#mathInput');
    const calcBtn = $('#calcBtn');
    const mathResult = $('#mathResult');
    const scoreDisplay = $('#scoreDisplay');
    const body = document.body;
    const easterModal = $('#easterModal');
    const closeEaster = $('#closeEaster');
    const storyModal = $('#storyModal');
    const closeStory = $('#closeStory');
    const masterModal = $('#masterModal');
    const whiteoutOverlay = $('#whiteoutOverlay');
    const whiteoutTimer = $('#whiteoutTimer');
    const whiteoutMinutes = $('#whiteoutMinutes');
    const whiteoutStart = $('#whiteoutStart');
    const whiteoutStop = $('#whiteoutStop');
    const whiteoutStopOverlay = $('#whiteoutStopOverlay');
    const focusNextTaskBtn = $('#focusNextTask');
    const focusThemeToggle = $('#focusThemeToggle');
    
    let score = 0;
    const totalTasks = checkboxes.length;
    
    /* ======================================
       FUNCTIONS: TASK PROGRESS & SCORE
       ====================================== */
    function updateProgress() {
      const completed = $$('.task-checkbox:checked').length;
      const percent = (completed / totalTasks) * 100;
      if (progressBar) {
        progressBar.style.width = percent + '%';
      }
    }
    function updateScore(points) {
      score += points;
      if(score < 0) score = 0;
      if (scoreDisplay) scoreDisplay.textContent = score;
    }
    function handleCheckboxChange() {
      const label = this.parentElement;
      label.classList.add('pulse');
      setTimeout(() => {
        label.classList.remove('pulse');
        label.classList.add('swap-clean');
        setTimeout(() => {
          if(this.checked) {
            label.classList.add('done');
            updateScore(10);
          } else {
            label.classList.remove('done');
            updateScore(-10);
          }
          label.classList.remove('swap-clean');
          updateProgress();
        }, 600);
      }, 500);
    }
    function resetTasks() {
      checkboxes.forEach(cb => {
        if(cb.checked) {
          cb.checked = false;
          const label = cb.parentElement;
          label.classList.add('swap-clean');
          setTimeout(() => {
            label.classList.remove('swap-clean', 'done');
            updateProgress();
          }, 600);
        }
      });
      score = 0;
      if (scoreDisplay) scoreDisplay.textContent = score;
    }
    function validateNextTask() {
      for(let cb of checkboxes) {
        if(!cb.checked) {
          cb.checked = true;
          handleCheckboxChange.call(cb);
          break;
        }
      }
    }
    
    /* ======================================
       MATH CALCULATOR FUNCTION
       ====================================== */
    function calculateMath() {
      if (!mathInput || !mathResult) return;
      let expr = mathInput.value;
      try {
        let result = Function('"use strict"; return (' + expr + ')')();
        mathResult.textContent = "R√©sultat : " + result;
      } catch(error) {
        mathResult.textContent = "Expression invalide.";
      }
    }
    
    /* ======================================
       THEME TOGGLE FUNCTION
       ====================================== */
    function toggleValentineTheme() {
      body.classList.toggle('valentine-theme');
    }
    
    /* ======================================
       EASTER EGG FUNCTION
       ====================================== */
    function triggerEasterEgg() {
      updateScore(50);
      if (easterModal) easterModal.style.display = 'block';
    }
    addListener(closeEaster, 'click', () => {
      if (easterModal) easterModal.style.display = 'none';
    });
    
    /* ======================================
       STORY HELPER FUNCTIONS
       ====================================== */
    addListener(closeStory, 'click', () => {
      if (storyModal) storyModal.style.display = 'none';
    });
    
    /* ======================================
       MASTER MODAL FUNCTIONS
       ====================================== */
    function openMasterModal() {
      if (masterModal) masterModal.style.display = 'block';
    }
    function closeMasterModal() {
      if (masterModal) masterModal.style.display = 'none';
    }
    function focusNotepad() {
      const notesWindow = document.getElementById('notesWindow');
      if(notesWindow) {
        notesWindow.style.zIndex = 1300;
        notesWindow.style.border = "2px solid var(--highlight-color)";
      }
      closeMasterModal();
    }
    
    /* ======================================
       FILE MANAGEMENT FUNCTIONS
       ====================================== */
    function fileAction(action) {
      const logDiv = document.getElementById('fileLog');
      const timestamp = new Date().toLocaleTimeString();
      if (logDiv) {
        logDiv.innerHTML += `<p>[${timestamp}] Action: ${action}</p>`;
        logDiv.scrollTop = logDiv.scrollHeight;
      }
    }
    
    /* ======================================
       COLLAPSIBLE FOLDERS
       ====================================== */
    function toggleFolder(id) {
      const folderContent = document.getElementById(id);
      if (!folderContent) return;
      folderContent.style.display = folderContent.style.display === 'block' ? 'none' : 'block';
    }
    
    /* ======================================
       DRAGGABLE WINDOWS (VIRTUAL DESKTOP)
       ====================================== */
    function makeDraggable(el) {
      let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
      const header = el.querySelector('.window-header');
      if(header) {
        header.onmousedown = dragMouseDown;
      } else {
        el.onmousedown = dragMouseDown;
      }
      function dragMouseDown(e) {
        e = e || window.event;
        e.preventDefault();
        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        document.onmousemove = elementDrag;
      }
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        el.style.top = (el.offsetTop - pos2) + "px";
        el.style.left = (el.offsetLeft - pos1) + "px";
      }
      function closeDragElement() {
        document.onmouseup = null;
        document.onmousemove = null;
      }
    }
    const windows = $$('.window');
    windows.forEach(win => makeDraggable(win));
    
    /* ======================================
       VIRTUAL NOTES: SAVE TO LOCAL STORAGE
       ====================================== */
    function saveNotes() {
      const notesArea = document.getElementById('notesArea');
      if (!notesArea) return;
      const notes = notesArea.value;
      localStorage.setItem('virtualNotes', notes);
      alert("Notes sauvegard√©es !");
    }
    window.addEventListener('load', () => {
      const savedNotes = localStorage.getItem('virtualNotes');
      const notesArea = document.getElementById('notesArea');
      if(savedNotes && notesArea) {
        notesArea.value = savedNotes;
      }
    });
    
    /* ======================================
       VIRTUAL FILE VIEWER EXAMPLE
       ====================================== */
    function openVirtualFile() {
      const fileContentDiv = document.getElementById('virtualFileContent');
      const equation = "E = mc¬≤";
      fileContentDiv.innerHTML = `<p>Contenu du fichier virtuel :</p><p>Une √©quation c√©l√®bre : <strong>${equation}</strong></p>`;
    }
    
    /* ======================================
       COIN GAME: GAMIFICATION DES OP√âRATIONS
       ====================================== */
    const startCoinGameBtn = $('#startCoinGame');
    const coinsInput = $('#coinsInput');
    const thresholdInput = $('#thresholdInput');
    const coinDisplay = $('#coinDisplay');
    const coinLog = $('#coinLog');
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
    function renderCoins(coins) {
      if (!coinDisplay) return;
      coinDisplay.innerHTML = "";
      coins.forEach(val => {
        const coinEl = document.createElement("div");
        coinEl.className = "coin";
        coinEl.textContent = val;
        coinDisplay.appendChild(coinEl);
      });
    }
    async function playCoinGame(coins, threshold) {
      let operations = 0;
      renderCoins(coins);
      if (coinLog) coinLog.innerHTML = "";
      while(coins.length > 1 && coins.some(val => val < threshold)) {
        coins.sort((a, b) => a - b);
        const x = coins.shift();
        const y = coins.shift();
        const newCoin = Math.min(x, y) * 2 + Math.max(x, y);
        operations++;
        if (coinLog) {
          coinLog.innerHTML += `<p>Op√©ration ${operations} : Fusion de ${x} et ${y} pour cr√©er ${newCoin}</p>`;
        }
        await sleep(1000);
        coins.push(newCoin);
        renderCoins(coins);
        await sleep(500);
      }
      if (coinLog) {
        coinLog.innerHTML += `<p><strong>Nombre minimum d'op√©rations n√©cessaires : ${operations}</strong></p>`;
      }
    }
    if(startCoinGameBtn) {
      startCoinGameBtn.addEventListener('click', () => {
        if (!coinsInput || !thresholdInput) return;
        const coinsStr = coinsInput.value;
        const threshold = parseInt(thresholdInput.value, 10);
        if(!coinsStr || isNaN(threshold)) {
          alert("Veuillez entrer des pi√®ces valides et un seuil.");
          return;
        }
        const coins = coinsStr.split(",").map(s => parseInt(s.trim())).filter(n => !isNaN(n));
        playCoinGame(coins, threshold);
      });
    }
    
    /* ======================================
       GLOBAL DYNAMIC ANIMATION (SIMPLE HARMONIC MOTION)
       ====================================== */
    function animateCards() {
      const cards = document.querySelectorAll('.card, .command-card, .score-card');
      const time = Date.now() / 1000;
      cards.forEach((card, index) => {
        const amplitude = 5;
        const frequency = 0.5;
        const phaseOffset = index * Math.PI / 6;
        const deltaY = amplitude * Math.sin(2 * Math.PI * frequency * time + phaseOffset);
        card.style.setProperty('--float-offset', `${deltaY}px`);
      });
      requestAnimationFrame(animateCards);
    }
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)');
    if (!prefersReducedMotion.matches) {
      requestAnimationFrame(animateCards);
    }

    /* ======================================
       WHITEOUT BREAK MODE
       ====================================== */
    let whiteoutInterval = null;
    let remainingSeconds = 0;
    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
      const secs = Math.floor(seconds % 60).toString().padStart(2, '0');
      return `${mins}:${secs}`;
    }
    function setWhiteoutActive(active) {
      if (!whiteoutOverlay) return;
      whiteoutOverlay.classList.toggle('is-active', active);
      whiteoutOverlay.setAttribute('aria-hidden', String(!active));
    }
    function updateWhiteoutDisplay() {
      if (whiteoutTimer) {
        whiteoutTimer.textContent = formatTime(remainingSeconds);
      }
    }
    function stopWhiteout() {
      if (whiteoutInterval) {
        clearInterval(whiteoutInterval);
        whiteoutInterval = null;
      }
      setWhiteoutActive(false);
    }
    function startWhiteout() {
      if (!whiteoutMinutes) return;
      const minutes = parseInt(whiteoutMinutes.value, 10);
      if (isNaN(minutes) || minutes <= 0) {
        alert("Veuillez choisir une dur√©e valide.");
        return;
      }
      remainingSeconds = Math.min(minutes, 30) * 60;
      updateWhiteoutDisplay();
      setWhiteoutActive(true);
      if (whiteoutInterval) clearInterval(whiteoutInterval);
      whiteoutInterval = setInterval(() => {
        remainingSeconds -= 1;
        updateWhiteoutDisplay();
        if (remainingSeconds <= 0) {
          stopWhiteout();
        }
      }, 1000);
    }
    
    /* ======================================
       EVENT LISTENERS FOR COMMANDS & SHORTCUTS
       ====================================== */
    checkboxes.forEach(cb => {
      cb.addEventListener('change', handleCheckboxChange);
    });
    addListener(resetBtn, 'click', resetTasks);
    addListener(calcBtn, 'click', calculateMath);
    document.addEventListener('keydown', function(e) {
      if(e.altKey && e.key.toLowerCase() === 'r') {
        e.preventDefault();
        resetTasks();
      }
      if(e.altKey && e.key.toLowerCase() === 'n') {
        e.preventDefault();
        validateNextTask();
      }
      if(e.altKey && e.key.toLowerCase() === 't') {
        e.preventDefault();
        toggleValentineTheme();
      }
    });
    addListener(commandInput, 'keydown', function(e) {
      if(e.key === 'Enter') {
        const command = commandInput.value.trim().toLowerCase();
        if(command === 'reset') {
          resetTasks();
        } else if(command === 'next') {
          validateNextTask();
        } else if(command === 'toggle') {
          toggleValentineTheme();
        } else if(command === 'aujourdh8onsa1m1') {
          triggerEasterEgg();
        }
        commandInput.value = '';
      }
    });
    
    /* ======================================
       TOGGLE CONTACT INFO (for Collaboration Card)
       ====================================== */
    function toggleContactInfo() {
      const contactInfo = document.getElementById("contactInfo");
      if (!contactInfo) return;
      if (contactInfo.style.display === "none") {
        contactInfo.style.display = "block";
      } else {
        contactInfo.style.display = "none";
      }
    }

    addListener(whiteoutStart, 'click', startWhiteout);
    addListener(whiteoutStop, 'click', stopWhiteout);
    addListener(whiteoutStopOverlay, 'click', stopWhiteout);
    addListener(focusNextTaskBtn, 'click', validateNextTask);
    addListener(focusThemeToggle, 'click', toggleValentineTheme);
  </script>
</body>
</html>
